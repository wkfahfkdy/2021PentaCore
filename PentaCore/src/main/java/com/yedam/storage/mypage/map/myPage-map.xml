<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.mypage.map.myPage-map">
	<select id="noticeSelectList" resultType="MyPageVO" parameterType="MyPageVO">
		select * 
		from notice
		where store_code = #{store_code}
		order by notice_num desc
	</select>
	
	<select id="usedStorageList" resultType="MyPageVO" parameterType="MyPageVO">
		select u.*, s.storage_width, s.storage_height, s.storage_vertical, s.storage_name, o.offer_product,
				o.offer_wash, o.offer_premium
		from storage s join offer o
		on (s.storage_code = o.storage_code)
		join use_storage u
		on (u.offer_code = o.offer_code)
		join store t
		on(u.store_code = t.store_code)
		where u.member_id = #{member_id}
	</select>
	
	<select id="useStorage" resultType="MyPageVO" parameterType="MyPageVO">
		select store_name
		from use_storage
		where member_id = #{member_id}
	</select>
	
	<select id="offerSelectList" resultType="MyPageVO" parameterType="MyPageVO">
		select o.*, s.store_name
		from offer o, store s
		where o.store_code = s.store_code
    	and member_id = #{member_id}
	</select>
	
	<select id="myOfferSelect" resultType="MyPageVO" parameterType="MyPageVO">
		select o.*, (o.offer_price*c.coupon_discount) as total_price, s.store_name, s.store_tel,s.STORE_ADDR, s.STORE_BUS, s.STORE_EMAIL,s.STORE_SUBWAY, t.storage_name, 
        t.STORAGE_PRICE, c.coupon_name
		from offer o join store s
		on (o.store_code = s.store_code)
		join storage t
		on (o.storage_code = t.storage_code)
		join coupon c
		on (o.COUPON_CODE = c.coupon_code)
		where offer_code = #{offer_code}
	</select>
	
	<select id="conveyListAll" resultType="MyPageVO" parameterType="MyPageVO">
		select c.*, a.apply_product, a.store_code, a.apply_start, s.store_name 
		from convey_list c join convey_apply a
		on (c.apply_code = a.apply_code)
		join store s
		on (a.store_code = s.store_code)
		where member_id = #{member_id}
	</select>
</mapper>